<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link rel="stylesheet" href="/css/authen.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"/>
    
    <!-- favicon img -->
    <link rel="shortcut icon" type="image/icon" href="/logo/favicon.png"/>

    <!-- Google sign-in -->
    <meta name="google-signin-scope" content="profile email">
    <meta name="google-signin-client_id" content="495383321459-21mtk5pg8m31a6u27pat4va44r6mijsa.apps.googleusercontent.com">
    <script src="https://apis.google.com/js/platform.js" async defer></script>
</head>
<body style="background-image: url('../images/profile/background.jpg'); background-repeat: no-repeat; background-size: cover;">
    <div class="row">
        <div class="col-md-6 mx-auto p-0">
            <div class="card">
                <div class="login-box">
                    <div class="login-snip">
                        <div style="margin-left: 32%; color:white; font-size: larger; font-weight: bold;">Travel Itinerary</div>
                        <a href="/">
                            <img src="logo/favicon.png" style="height: 100px; margin-left: 35%"> <br>
                        </a>
                        <input id="tab-1" type="radio" name="tab" class="sign-in" checked><label for="tab-1" class="tab">Login</label> <input id="tab-2" type="radio" name="tab" class="sign-up"><label for="tab-2" class="tab">Sign Up</label>
                        <div class="login-space">
                            <div class="login">
                                <form method="POST" action="/login" id="sign-in">
                                    <div class="group"> <label for="user" class="label">Username</label> <input id="si-user" type="text" class="input" placeholder="Enter your username" minlength="3" maxlength="15" required> </div>
                                    <div class="group"> <label for="pass" class="label">Password</label> <input id="si-pass" type="password" class="input" data-type="password" placeholder="Enter your password" minlength="7" maxlength="15" required> </div>
                                    <div class="group"> <input id="check" type="checkbox" class="check" checked> <label for="check"><span class="icon"></span> Keep me Signed in</label> </div>
                                    <div class="group"> <input type="submit" class="button" value="Sign In"> </div>
                                    <p class="text-danger text-center font-weight-bolder text-monospace" id="si-noti"></p>
                                    <div class="hr"></div>
                                    <div class="foot"> <a href="#">Forgot Password?</a> </div>
                                    <div class="g-signin2" data-onsuccess="onSignIn" data-theme="dark" id="sign-in-google"></div>
                                </form>
                            </div>
                            <div class="sign-up-form">
                                <form method="POST" action="login" id="sign-up">
                                    <div class="group"> <label for="user" class="label">Username</label> <input id="su-user" type="text" class="input" placeholder="Create your Username" minlength="3" maxlength="15" pattern="[A-Za-z0-9]{1,}" title = "Username can only contain numbers and letters." required> </div>
                                    <div class="group"> <label for="pass" class="label">Password</label> <input id="su-pass" type="password" class="input" data-type="password" placeholder="Create your Password" minlength="8" maxlength="20" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{1,}" title="Must contain at least one number and one uppercase and lowercase letter" required> </div>
                                    <div class="group"> <label for="pass" class="label">Repeat Password <span class="text-danger text-center font-weight-bolder text-monospace" id="su-noti"></span> </label> <input id="su-repass" type="password" class="input" data-type="password" placeholder="Repeat your Password" minlength="8" maxlength="20" required> </div>
                                    <div class="group"> <label for="pass" class="label">Email Address</label> <input id="su-email" type="email" class="input" placeholder="Enter your Email address" maxlength="254" required> </div>
                                    <div class="group"> <input type="submit" class="button" value="Sign Up"> </div>
                                    <div class="foot"> <label for="tab-1">Already Member?</label> </div>
                                </form>
                                
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
    <script src="/js/bootstrap.bundle.js"></script>
    <script src="/js/jquery.min.js"></script>

    <!--Handle information before send to server-->
    <script>
        var username_verify = /^[0-9a-zA-Z]+$/;
        var pass_verify =  /^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{7,15}$/;

        $('#sign-up').on('submit', function(e) {
            e.preventDefault();
            //Check user name
            var username = $('#su-user').val();
            if (!username.match(username_verify)) {
                $('#su-noti').text("Username can only contain numbers and letters.");
                return;
            }
            //Check password
            var pass = $('#su-pass').val();
            // if(!pass.match(pass_verify)) 
            //     $('#su-noti').text("Your password must contain at least 1 digit and 1 special character!");
            //     return;
            //Check re password
            var re_pass = $('#su-repass').val();
            if (pass.localeCompare(re_pass) != 0) {
                $('#su-noti').text("Your confirm password is not correct.");
                return;
            }

            $('#su-noti').text("Success");
            //check username exists, insert code below this line to check
            //check email exists, insert code below this line to check
        })

        $('#sign-in').on('submit', function(e) {
            e.preventDefault();

            $('#si-noti').text("hello");
            //Check user name
            var username = $('#si-user').val();
            if (!username.match(username_verify)) {
                $('#si-noti').text("Username can only contain numbers and letters.");
                return;
            }
            //Check password
            var pass = $('#si-pass').val();
            if(!pass.match(pass_verify)) 
                $('#si-noti').text("Your password must contain at least 1 digit and 1 special character!");
                return;

            //check if username exists
            //check if password correct
        });
    </script>

    <!-- Google sign-in  -->
    <script>
        // $('#sign-in-google').on('onSignIn', function(e){
        //     e.preventDefault();

        //     console.log("hello");
        //     var profile = googleUser.getBasicProfile();
        //     console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
        //     console.log('Name: ' + profile.getName());
        //     console.log('Image URL: ' + profile.getImageUrl());
        //     console.log('Email: ' + profile.getEmail()); // This is null if the 'email' scope is not present.
        // })
        function onSignIn(googleUser) {
            var profile = googleUser.getBasicProfile();
            //console.log('ID: ' + profile.getId()); // Do not send to your backend! Use an ID token instead.
            //console.log('Image URL: ' + profile.getImageUrl());
            //console.log('Name: ' + profile.getName());
            //console.log('Email: ' + profile.getEmail());
            var user_uname = profile.getName();
            var user_email = profile.getEmail();
            alert(user_uname);
        }
    </script>
</html>